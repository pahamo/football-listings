{"ast":null,"code":"import { createClient } from '@supabase/supabase-js';\n// Get credentials from environment variables with fallbacks\nconst supabaseUrl = process.env.REACT_APP_SUPABASE_URL || 'https://nkfuzkrazehjivzmdrvt.supabase.co';\nconst supabaseAnonKey = process.env.REACT_APP_SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5rZnV6a3JhemVoaml2em1kcnZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcyNjI5MzAsImV4cCI6MjA3MjgzODkzMH0.CNW1EUtcC4JWfDy-WzOIVDfv7rnXzsz1qqQyRTZVyXU';\n\n// Log a warning if using fallback credentials\nif (!process.env.REACT_APP_SUPABASE_URL || !process.env.REACT_APP_SUPABASE_ANON_KEY) {\n  console.warn('[Supabase] Using fallback credentials. Consider setting REACT_APP_SUPABASE_URL and REACT_APP_SUPABASE_ANON_KEY in your .env file.');\n}\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\nfunction mapFixtureRow(row, providersByFixture = {}) {\n  var _row$matchday, _row$venue;\n  const kickoffIso = row.utc_kickoff;\n  const mw = (_row$matchday = row.matchday) !== null && _row$matchday !== void 0 ? _row$matchday : null;\n  const home = {\n    id: row.home_team_id,\n    name: row.home_team,\n    slug: row.home_slug,\n    crest: row.home_crest || null\n  };\n  const away = {\n    id: row.away_team_id,\n    name: row.away_team,\n    slug: row.away_slug,\n    crest: row.away_crest || null\n  };\n  const providers = providersByFixture[row.id] || [];\n\n  // Check blackout status from localStorage (matching original SPA logic)\n  const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n  const isBlackout = blackoutFixtures.includes(row.id);\n  return {\n    id: row.id,\n    sport: 'football',\n    competition: 'premier-league',\n    matchweek: mw,\n    kickoff_utc: kickoffIso,\n    venue: (_row$venue = row.venue) !== null && _row$venue !== void 0 ? _row$venue : null,\n    home,\n    away,\n    providers_uk: providers,\n    blackout: {\n      is_blackout: isBlackout,\n      reason: isBlackout ? 'No UK broadcaster announced' : null\n    },\n    status: row.status || 'scheduled'\n  };\n}\nasync function getBroadcastsForFixtures(ids) {\n  try {\n    if (!ids || !ids.length) return [];\n    const {\n      data,\n      error\n    } = await supabase.from('broadcasts').select('fixture_id,provider_id').in('fixture_id', ids);\n    if (error) {\n      console.warn('[Supabase] getBroadcastsForFixtures error', error);\n      return [];\n    }\n    return data || [];\n  } catch (e) {\n    console.warn('[Supabase] getBroadcastsForFixtures error', e);\n    return [];\n  }\n}\nasync function getProvidersByIds(ids = []) {\n  try {\n    let query = supabase.from('providers').select('id,display_name,name,type,url').order('display_name', {\n      ascending: true\n    });\n    if (ids.length > 0) {\n      query = query.in('id', ids);\n    }\n    const {\n      data: rows,\n      error\n    } = await query;\n    if (error) {\n      console.warn('[Supabase] getProvidersByIds error', error);\n      return [];\n    }\n    const mapped = (rows || []).map(p => ({\n      id: String(p.id),\n      name: p.display_name || p.name || 'Unknown',\n      type: p.type || 'unknown',\n      href: p.url || undefined,\n      status: 'confirmed'\n    }));\n\n    // Fallbacks for common UK providers in case providers table is incomplete\n    const byId = new Map(mapped.map(p => [p.id, p]));\n    const ensure = (numId, name, href) => {\n      const key = String(numId);\n      if (!byId.has(key) && ids.includes(numId)) {\n        byId.set(key, {\n          id: key,\n          name,\n          type: 'tv',\n          href,\n          status: 'confirmed'\n        });\n      }\n    };\n    ensure(1, 'Sky Sports', 'https://www.skysports.com/football/fixtures-results');\n    ensure(2, 'TNT Sports', 'https://tntsports.co.uk/football');\n    return Array.from(byId.values());\n  } catch (e) {\n    console.warn('[Supabase] getProvidersByIds error', e);\n    return [];\n  }\n}\nexport async function getFixtures(params = {}) {\n  try {\n    const {\n      teamSlug,\n      dateFrom,\n      dateTo,\n      limit = 100,\n      order = 'asc',\n      competitionId\n    } = params;\n    let query = supabase.from('fixtures_with_teams').select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `).order('utc_kickoff', {\n      ascending: order === 'asc'\n    }).limit(limit);\n    if (dateFrom) {\n      query = query.gte('utc_kickoff', dateFrom);\n    }\n    if (dateTo) {\n      query = query.lte('utc_kickoff', dateTo);\n    }\n    if (competitionId) {\n      query = query.eq('competition_id', competitionId);\n    }\n    const {\n      data: rows,\n      error\n    } = await query;\n    if (error) {\n      console.warn('[Supabase] getFixtures error', error);\n      return [];\n    }\n    if (!rows || !rows.length) return [];\n\n    // Enrich providers in a second step\n    const ids = rows.map(r => r.id).filter(Boolean);\n    let providersByFixture = {};\n    if (ids.length) {\n      const bcasts = await getBroadcastsForFixtures(ids);\n      const providerIds = Array.from(new Set(bcasts.map(b => b.provider_id).filter(Boolean)));\n      const provs = providerIds.length ? await getProvidersByIds(providerIds) : [];\n      const byPk = Object.fromEntries(provs.map(p => [p.id, p]));\n      for (const b of bcasts) {\n        const fId = b.fixture_id;\n        const key = String(b.provider_id);\n        const p = byPk[key];\n        const entry = p ? {\n          ...p\n        } : undefined;\n        if (!providersByFixture[fId]) providersByFixture[fId] = [];\n        if (entry) providersByFixture[fId].push(entry);\n      }\n    }\n    let mapped = rows.map(r => mapFixtureRow(r, providersByFixture));\n\n    // Apply team filter if specified\n    if (teamSlug) {\n      mapped = mapped.filter(fx => fx.home.slug === teamSlug || fx.away.slug === teamSlug);\n    }\n\n    // Apply filtering logic to exclude test fixtures (IDs <= 30)\n    // This matches the current SPA's filtering logic\n    mapped = mapped.filter(f => f.id && f.id > 30);\n    return mapped;\n  } catch (e) {\n    console.warn('[Supabase] getFixtures error', e);\n    return [];\n  }\n}\nexport async function getFixtureById(id) {\n  try {\n    if (!id) return undefined;\n    const {\n      data: rows,\n      error\n    } = await supabase.from('fixtures_with_teams').select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `).eq('id', id).limit(1);\n    if (error) {\n      console.warn('[Supabase] getFixtureById error', error);\n      return undefined;\n    }\n    const row = rows === null || rows === void 0 ? void 0 : rows[0];\n    if (!row) return undefined;\n    const bcasts = await getBroadcastsForFixtures([row.id]);\n    const providerIds = Array.from(new Set(bcasts.map(b => b.provider_id).filter(Boolean)));\n    const provs = providerIds.length ? await getProvidersByIds(providerIds) : [];\n    const byPk = Object.fromEntries(provs.map(p => [p.id, p]));\n    const providersByFixture = {};\n    providersByFixture[row.id] = bcasts.map(b => {\n      const p = byPk[String(b.provider_id)];\n      return p ? {\n        ...p\n      } : null;\n    }).filter(Boolean);\n    return mapFixtureRow(row, providersByFixture);\n  } catch (e) {\n    console.warn('[Supabase] getFixtureById error', e);\n    return undefined;\n  }\n}\n\n// Admin API functions\n\nexport const BROADCASTERS = [{\n  id: 1,\n  name: 'Sky Sports',\n  type: 'tv'\n}, {\n  id: 2,\n  name: 'TNT Sports',\n  type: 'tv'\n}, {\n  id: 3,\n  name: 'BBC Sport',\n  type: 'tv'\n}, {\n  id: 4,\n  name: 'Amazon Prime Video',\n  type: 'streaming'\n}, {\n  id: -1,\n  name: 'ðŸš« Blackout (No TV)',\n  type: 'blackout'\n}];\nexport async function getAdminFixtures(competitionId = 1) {\n  try {\n    // Get fixtures from current season\n    const currentSeasonStart = '2024-08-01T00:00:00.000Z';\n    const {\n      data: rows,\n      error\n    } = await supabase.from('fixtures_with_teams').select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `).eq('competition_id', competitionId).gte('utc_kickoff', currentSeasonStart).order('utc_kickoff', {\n      ascending: true\n    });\n    if (error) {\n      console.warn('[Supabase] getAdminFixtures error', error);\n      return [];\n    }\n    if (!rows || !rows.length) return [];\n\n    // Apply same filtering as main app (exclude test fixtures)\n    const validRows = rows.filter(r => r.id && r.id > 30);\n\n    // Get all broadcasts for these fixtures\n    const fixtureIds = validRows.map(r => r.id);\n    const {\n      data: broadcasts,\n      error: broadcastError\n    } = await supabase.from('broadcasts').select('fixture_id,provider_id').in('fixture_id', fixtureIds);\n    if (broadcastError) {\n      console.warn('[Supabase] Error loading broadcasts:', broadcastError);\n    }\n\n    // Create broadcast lookup\n    const broadcastLookup = {};\n    (broadcasts || []).forEach(b => {\n      broadcastLookup[b.fixture_id] = b;\n    });\n\n    // Map fixtures with broadcast info\n    const adminFixtures = validRows.map(row => {\n      var _BROADCASTERS$find;\n      const broadcast = broadcastLookup[row.id] || null;\n      const fixture = mapFixtureRow(row);\n      return {\n        ...fixture,\n        broadcast: broadcast ? {\n          provider_id: broadcast.provider_id,\n          provider_display_name: ((_BROADCASTERS$find = BROADCASTERS.find(b => b.id === broadcast.provider_id)) === null || _BROADCASTERS$find === void 0 ? void 0 : _BROADCASTERS$find.name) || 'Unknown'\n        } : null\n      };\n    });\n    return adminFixtures;\n  } catch (e) {\n    console.warn('[Supabase] getAdminFixtures error', e);\n    return [];\n  }\n}\nexport async function saveBroadcast(fixtureId, providerId) {\n  try {\n    if (providerId === '' || providerId === '0' || providerId === '-1' || providerId === null) {\n      // Delete existing broadcast record\n      const {\n        error\n      } = await supabase.from('broadcasts').delete().eq('fixture_id', fixtureId);\n      if (error) {\n        throw error;\n      }\n\n      // Handle blackout localStorage logic\n      if (providerId === '-1') {\n        const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n        if (!blackoutFixtures.includes(fixtureId)) {\n          blackoutFixtures.push(fixtureId);\n          localStorage.setItem('blackoutFixtures', JSON.stringify(blackoutFixtures));\n        }\n      } else {\n        // Remove from blackout list if setting to empty\n        const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n        const updatedBlackout = blackoutFixtures.filter(id => id !== fixtureId);\n        localStorage.setItem('blackoutFixtures', JSON.stringify(updatedBlackout));\n      }\n    } else {\n      // Add/update broadcaster - remove from blackout list first\n      const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n      const updatedBlackout = blackoutFixtures.filter(id => id !== fixtureId);\n      localStorage.setItem('blackoutFixtures', JSON.stringify(updatedBlackout));\n      const broadcastData = {\n        fixture_id: fixtureId,\n        provider_id: parseInt(String(providerId))\n      };\n\n      // Upsert the broadcast record\n      const {\n        error\n      } = await supabase.from('broadcasts').upsert(broadcastData);\n      if (error) {\n        throw error;\n      }\n    }\n  } catch (e) {\n    console.error('[Supabase] saveBroadcast error', e);\n    throw e;\n  }\n}\n\n// Blackout helper functions\nexport function isFixtureBlackout(fixtureId) {\n  const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n  return blackoutFixtures.includes(fixtureId);\n}\nexport function isFixtureConfirmed(fixture) {\n  return !!(fixture.broadcast && fixture.broadcast.provider_id && !isFixtureBlackout(fixture.id));\n}\nexport function isFixturePending(fixture) {\n  return !fixture.broadcast && !isFixtureBlackout(fixture.id);\n}\n\n// Teams API\nexport async function getTeams() {\n  try {\n    const {\n      data,\n      error\n    } = await supabase.from('teams').select('id,name,slug,crest_url').eq('is_active', true).order('name', {\n      ascending: true\n    });\n    if (error) {\n      console.warn('[Supabase] getTeams error', error);\n      return [];\n    }\n    return (data || []).map(t => {\n      var _t$crest_url;\n      return {\n        id: t.id,\n        name: t.name,\n        slug: t.slug,\n        crest: (_t$crest_url = t.crest_url) !== null && _t$crest_url !== void 0 ? _t$crest_url : null\n      };\n    });\n  } catch (e) {\n    console.warn('[Supabase] getTeams error', e);\n    return [];\n  }\n}","map":{"version":3,"names":["createClient","supabaseUrl","process","env","REACT_APP_SUPABASE_URL","supabaseAnonKey","REACT_APP_SUPABASE_ANON_KEY","console","warn","supabase","mapFixtureRow","row","providersByFixture","_row$matchday","_row$venue","kickoffIso","utc_kickoff","mw","matchday","home","id","home_team_id","name","home_team","slug","home_slug","crest","home_crest","away","away_team_id","away_team","away_slug","away_crest","providers","blackoutFixtures","JSON","parse","localStorage","getItem","isBlackout","includes","sport","competition","matchweek","kickoff_utc","venue","providers_uk","blackout","is_blackout","reason","status","getBroadcastsForFixtures","ids","length","data","error","from","select","in","e","getProvidersByIds","query","order","ascending","rows","mapped","map","p","String","display_name","type","href","url","undefined","byId","Map","ensure","numId","key","has","set","Array","values","getFixtures","params","teamSlug","dateFrom","dateTo","limit","competitionId","gte","lte","eq","r","filter","Boolean","bcasts","providerIds","Set","b","provider_id","provs","byPk","Object","fromEntries","fId","fixture_id","entry","push","fx","f","getFixtureById","BROADCASTERS","getAdminFixtures","currentSeasonStart","validRows","fixtureIds","broadcasts","broadcastError","broadcastLookup","forEach","adminFixtures","_BROADCASTERS$find","broadcast","fixture","provider_display_name","find","saveBroadcast","fixtureId","providerId","delete","setItem","stringify","updatedBlackout","broadcastData","parseInt","upsert","isFixtureBlackout","isFixtureConfirmed","isFixturePending","getTeams","t","_t$crest_url","crest_url"],"sources":["/Users/p/Documents/pl_tv_mvp_spa/react-version/src/services/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\nimport type { Fixture, FixturesApiParams, Provider, Team } from '../types';\n\n// Get credentials from environment variables with fallbacks\nconst supabaseUrl = process.env.REACT_APP_SUPABASE_URL || 'https://nkfuzkrazehjivzmdrvt.supabase.co';\nconst supabaseAnonKey = process.env.REACT_APP_SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5rZnV6a3JhemVoaml2em1kcnZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcyNjI5MzAsImV4cCI6MjA3MjgzODkzMH0.CNW1EUtcC4JWfDy-WzOIVDfv7rnXzsz1qqQyRTZVyXU';\n\n// Log a warning if using fallback credentials\nif (!process.env.REACT_APP_SUPABASE_URL || !process.env.REACT_APP_SUPABASE_ANON_KEY) {\n  console.warn('[Supabase] Using fallback credentials. Consider setting REACT_APP_SUPABASE_URL and REACT_APP_SUPABASE_ANON_KEY in your .env file.');\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n\ninterface FixtureRow {\n  id: number;\n  matchday?: number | null;\n  utc_kickoff: string;\n  venue?: string | null;\n  status?: string;\n  home_team_id: number;\n  home_team: string;\n  home_slug: string;\n  home_crest?: string | null;\n  away_team_id: number;\n  away_team: string;\n  away_slug: string;\n  away_crest?: string | null;\n}\n\ninterface BroadcastRow {\n  fixture_id: number;\n  provider_id: number;\n}\n\ninterface ProviderRow {\n  id: number;\n  slug?: string;\n  display_name?: string;\n  name?: string;\n  type?: string;\n  url?: string;\n}\n\nfunction mapFixtureRow(row: FixtureRow, providersByFixture: Record<number, Provider[]> = {}): Fixture {\n  const kickoffIso = row.utc_kickoff;\n  const mw = row.matchday ?? null;\n  const home: Team = {\n    id: row.home_team_id,\n    name: row.home_team,\n    slug: row.home_slug,\n    crest: row.home_crest || null,\n  };\n  const away: Team = {\n    id: row.away_team_id,\n    name: row.away_team,\n    slug: row.away_slug,\n    crest: row.away_crest || null,\n  };\n  const providers = providersByFixture[row.id] || [];\n\n  // Check blackout status from localStorage (matching original SPA logic)\n  const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n  const isBlackout = blackoutFixtures.includes(row.id);\n\n  return {\n    id: row.id,\n    sport: 'football',\n    competition: 'premier-league',\n    matchweek: mw,\n    kickoff_utc: kickoffIso,\n    venue: row.venue ?? null,\n    home,\n    away,\n    providers_uk: providers,\n    blackout: { \n      is_blackout: isBlackout, \n      reason: isBlackout ? 'No UK broadcaster announced' : null \n    },\n    status: row.status || 'scheduled',\n  };\n}\n\nasync function getBroadcastsForFixtures(ids: number[]): Promise<BroadcastRow[]> {\n  try {\n    if (!ids || !ids.length) return [];\n    \n    const { data, error } = await supabase\n      .from('broadcasts')\n      .select('fixture_id,provider_id')\n      .in('fixture_id', ids);\n      \n    if (error) {\n      console.warn('[Supabase] getBroadcastsForFixtures error', error);\n      return [];\n    }\n    \n    return data || [];\n  } catch (e) {\n    console.warn('[Supabase] getBroadcastsForFixtures error', e);\n    return [];\n  }\n}\n\nasync function getProvidersByIds(ids: number[] = []): Promise<Provider[]> {\n  try {\n    let query = supabase\n      .from('providers')\n      .select('id,display_name,name,type,url')\n      .order('display_name', { ascending: true });\n      \n    if (ids.length > 0) {\n      query = query.in('id', ids);\n    }\n    \n    const { data: rows, error } = await query;\n    \n    if (error) {\n      console.warn('[Supabase] getProvidersByIds error', error);\n      return [];\n    }\n    \n    const mapped = (rows || []).map((p: ProviderRow) => ({\n      id: String(p.id),\n      name: p.display_name || p.name || 'Unknown',\n      type: p.type || 'unknown',\n      href: p.url || undefined,\n      status: 'confirmed',\n    }));\n\n    // Fallbacks for common UK providers in case providers table is incomplete\n    const byId = new Map<string, Provider>(mapped.map(p => [p.id, p]));\n    const ensure = (numId: number, name: string, href: string) => {\n      const key = String(numId);\n      if (!byId.has(key) && ids.includes(numId)) {\n        byId.set(key, { id: key, name, type: 'tv', href, status: 'confirmed' });\n      }\n    };\n    ensure(1, 'Sky Sports', 'https://www.skysports.com/football/fixtures-results');\n    ensure(2, 'TNT Sports', 'https://tntsports.co.uk/football');\n\n    return Array.from(byId.values());\n  } catch (e) {\n    console.warn('[Supabase] getProvidersByIds error', e);\n    return [];\n  }\n}\n\nexport async function getFixtures(params: FixturesApiParams = {}): Promise<Fixture[]> {\n  try {\n    const {\n      teamSlug,\n      dateFrom,\n      dateTo,\n      limit = 100,\n      order = 'asc',\n      competitionId\n    } = params;\n\n    let query = supabase\n      .from('fixtures_with_teams')\n      .select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `)\n      .order('utc_kickoff', { ascending: order === 'asc' })\n      .limit(limit);\n      \n    if (dateFrom) {\n      query = query.gte('utc_kickoff', dateFrom);\n    }\n    if (dateTo) {\n      query = query.lte('utc_kickoff', dateTo);\n    }\n    if (competitionId) {\n      query = query.eq('competition_id', competitionId);\n    }\n\n    const { data: rows, error } = await query;\n    \n    if (error) {\n      console.warn('[Supabase] getFixtures error', error);\n      return [];\n    }\n    \n    if (!rows || !rows.length) return [];\n\n    // Enrich providers in a second step\n    const ids = rows.map(r => r.id).filter(Boolean);\n    let providersByFixture: Record<number, Provider[]> = {};\n    \n    if (ids.length) {\n      const bcasts = await getBroadcastsForFixtures(ids);\n      const providerIds = Array.from(new Set(bcasts.map(b => b.provider_id).filter(Boolean)));\n      const provs = providerIds.length ? await getProvidersByIds(providerIds) : [];\n      const byPk = Object.fromEntries(provs.map(p => [p.id, p]));\n\n      for (const b of bcasts) {\n        const fId = b.fixture_id;\n        const key = String(b.provider_id);\n        const p = byPk[key];\n        const entry = p ? { ...p } : undefined;\n        if (!providersByFixture[fId]) providersByFixture[fId] = [];\n        if (entry) providersByFixture[fId].push(entry);\n      }\n    }\n    \n    let mapped = rows.map(r => mapFixtureRow(r, providersByFixture));\n\n    // Apply team filter if specified\n    if (teamSlug) {\n      mapped = mapped.filter(fx => fx.home.slug === teamSlug || fx.away.slug === teamSlug);\n    }\n    \n    // Apply filtering logic to exclude test fixtures (IDs <= 30)\n    // This matches the current SPA's filtering logic\n    mapped = mapped.filter(f => f.id && f.id > 30);\n    \n    return mapped;\n  } catch (e) {\n    console.warn('[Supabase] getFixtures error', e);\n    return [];\n  }\n}\n\nexport async function getFixtureById(id: number): Promise<Fixture | undefined> {\n  try {\n    if (!id) return undefined;\n    \n    const { data: rows, error } = await supabase\n      .from('fixtures_with_teams')\n      .select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `)\n      .eq('id', id)\n      .limit(1);\n      \n    if (error) {\n      console.warn('[Supabase] getFixtureById error', error);\n      return undefined;\n    }\n    \n    const row = rows?.[0];\n    if (!row) return undefined;\n    \n    const bcasts = await getBroadcastsForFixtures([row.id]);\n    const providerIds = Array.from(new Set(bcasts.map(b => b.provider_id).filter(Boolean)));\n    const provs = providerIds.length ? await getProvidersByIds(providerIds) : [];\n    const byPk = Object.fromEntries(provs.map(p => [p.id, p]));\n\n    const providersByFixture: Record<number, Provider[]> = {};\n    providersByFixture[row.id] = bcasts.map(b => {\n      const p = byPk[String(b.provider_id)];\n      return p ? { ...p } : null;\n    }).filter(Boolean) as Provider[];\n    \n    return mapFixtureRow(row, providersByFixture);\n  } catch (e) {\n    console.warn('[Supabase] getFixtureById error', e);\n    return undefined;\n  }\n}\n\n// Admin API functions\n\nexport interface AdminFixture extends Fixture {\n  broadcast?: {\n    provider_id: number;\n    provider_display_name?: string;\n    channel?: string;\n  } | null;\n}\n\nexport const BROADCASTERS = [\n  { id: 1, name: 'Sky Sports', type: 'tv' },\n  { id: 2, name: 'TNT Sports', type: 'tv' },\n  { id: 3, name: 'BBC Sport', type: 'tv' },\n  { id: 4, name: 'Amazon Prime Video', type: 'streaming' },\n  { id: -1, name: 'ðŸš« Blackout (No TV)', type: 'blackout' }\n];\n\nexport async function getAdminFixtures(competitionId: number = 1): Promise<AdminFixture[]> {\n  try {\n    // Get fixtures from current season\n    const currentSeasonStart = '2024-08-01T00:00:00.000Z';\n    \n    const { data: rows, error } = await supabase\n      .from('fixtures_with_teams')\n      .select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `)\n      .eq('competition_id', competitionId)\n      .gte('utc_kickoff', currentSeasonStart)\n      .order('utc_kickoff', { ascending: true });\n      \n    if (error) {\n      console.warn('[Supabase] getAdminFixtures error', error);\n      return [];\n    }\n    \n    if (!rows || !rows.length) return [];\n\n    // Apply same filtering as main app (exclude test fixtures)\n    const validRows = rows.filter(r => r.id && r.id > 30);\n    \n    // Get all broadcasts for these fixtures\n    const fixtureIds = validRows.map(r => r.id);\n    const { data: broadcasts, error: broadcastError } = await supabase\n      .from('broadcasts')\n      .select('fixture_id,provider_id')\n      .in('fixture_id', fixtureIds);\n      \n    if (broadcastError) {\n      console.warn('[Supabase] Error loading broadcasts:', broadcastError);\n    }\n    \n    // Create broadcast lookup\n    const broadcastLookup: Record<number, BroadcastRow> = {};\n    (broadcasts || []).forEach(b => {\n      broadcastLookup[b.fixture_id] = b;\n    });\n    \n    // Map fixtures with broadcast info\n    const adminFixtures: AdminFixture[] = validRows.map(row => {\n      const broadcast = broadcastLookup[row.id] || null;\n      const fixture = mapFixtureRow(row);\n      \n      return {\n        ...fixture,\n        broadcast: broadcast ? {\n          provider_id: broadcast.provider_id,\n          provider_display_name: BROADCASTERS.find(b => b.id === broadcast.provider_id)?.name || 'Unknown'\n        } : null\n      };\n    });\n    \n    return adminFixtures;\n  } catch (e) {\n    console.warn('[Supabase] getAdminFixtures error', e);\n    return [];\n  }\n}\n\nexport async function saveBroadcast(fixtureId: number, providerId: number | string | null): Promise<void> {\n  try {\n    if (providerId === '' || providerId === '0' || providerId === '-1' || providerId === null) {\n      // Delete existing broadcast record\n      const { error } = await supabase\n        .from('broadcasts')\n        .delete()\n        .eq('fixture_id', fixtureId);\n        \n      if (error) {\n        throw error;\n      }\n      \n      // Handle blackout localStorage logic\n      if (providerId === '-1') {\n        const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n        if (!blackoutFixtures.includes(fixtureId)) {\n          blackoutFixtures.push(fixtureId);\n          localStorage.setItem('blackoutFixtures', JSON.stringify(blackoutFixtures));\n        }\n      } else {\n        // Remove from blackout list if setting to empty\n        const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n        const updatedBlackout = blackoutFixtures.filter((id: number) => id !== fixtureId);\n        localStorage.setItem('blackoutFixtures', JSON.stringify(updatedBlackout));\n      }\n    } else {\n      // Add/update broadcaster - remove from blackout list first\n      const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n      const updatedBlackout = blackoutFixtures.filter((id: number) => id !== fixtureId);\n      localStorage.setItem('blackoutFixtures', JSON.stringify(updatedBlackout));\n      \n      const broadcastData = {\n        fixture_id: fixtureId,\n        provider_id: parseInt(String(providerId))\n      };\n      \n      // Upsert the broadcast record\n      const { error } = await supabase\n        .from('broadcasts')\n        .upsert(broadcastData);\n        \n      if (error) {\n        throw error;\n      }\n    }\n  } catch (e) {\n    console.error('[Supabase] saveBroadcast error', e);\n    throw e;\n  }\n}\n\n// Blackout helper functions\nexport function isFixtureBlackout(fixtureId: number): boolean {\n  const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n  return blackoutFixtures.includes(fixtureId);\n}\n\nexport function isFixtureConfirmed(fixture: AdminFixture): boolean {\n  return !!(fixture.broadcast && fixture.broadcast.provider_id && !isFixtureBlackout(fixture.id));\n}\n\nexport function isFixturePending(fixture: AdminFixture): boolean {\n  return !fixture.broadcast && !isFixtureBlackout(fixture.id);\n}\n\n// Teams API\nexport async function getTeams(): Promise<Team[]> {\n  try {\n    const { data, error } = await supabase\n      .from('teams')\n      .select('id,name,slug,crest_url')\n      .eq('is_active', true)\n      .order('name', { ascending: true });\n\n    if (error) {\n      console.warn('[Supabase] getTeams error', error);\n      return [];\n    }\n    return (data || []).map((t: any) => ({\n      id: t.id,\n      name: t.name,\n      slug: t.slug,\n      crest: t.crest_url ?? null,\n    }));\n  } catch (e) {\n    console.warn('[Supabase] getTeams error', e);\n    return [];\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}