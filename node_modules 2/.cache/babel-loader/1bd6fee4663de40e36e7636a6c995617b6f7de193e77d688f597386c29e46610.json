{"ast":null,"code":"import { createClient } from '@supabase/supabase-js';\n// Require credentials from environment variables\nconst supabaseUrl = process.env.REACT_APP_SUPABASE_URL;\nconst supabaseAnonKey = process.env.REACT_APP_SUPABASE_ANON_KEY;\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('[Supabase] Missing REACT_APP_SUPABASE_URL or REACT_APP_SUPABASE_ANON_KEY');\n}\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\nfunction mapFixtureRow(row, providersByFixture = {}) {\n  var _row$matchday, _row$venue;\n  const kickoffIso = row.utc_kickoff;\n  const mw = (_row$matchday = row.matchday) !== null && _row$matchday !== void 0 ? _row$matchday : null;\n  const home = {\n    id: row.home_team_id,\n    name: row.home_team,\n    slug: row.home_slug,\n    crest: row.home_crest || null\n  };\n  const away = {\n    id: row.away_team_id,\n    name: row.away_team,\n    slug: row.away_slug,\n    crest: row.away_crest || null\n  };\n  const providers = providersByFixture[row.id] || [];\n\n  // Check blackout status from localStorage (matching original SPA logic)\n  const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n  const isBlackout = blackoutFixtures.includes(row.id);\n  return {\n    id: row.id,\n    sport: 'football',\n    competition: 'premier-league',\n    matchweek: mw,\n    kickoff_utc: kickoffIso,\n    venue: (_row$venue = row.venue) !== null && _row$venue !== void 0 ? _row$venue : null,\n    home,\n    away,\n    providers_uk: providers,\n    blackout: {\n      is_blackout: isBlackout,\n      reason: isBlackout ? 'No UK broadcaster announced' : null\n    },\n    status: row.status || 'scheduled'\n  };\n}\nasync function getBroadcastsForFixtures(ids) {\n  try {\n    if (!ids || !ids.length) return [];\n    const {\n      data,\n      error\n    } = await supabase.from('broadcasts').select('fixture_id,provider_id').in('fixture_id', ids);\n    if (error) {\n      console.warn('[Supabase] getBroadcastsForFixtures error', error);\n      return [];\n    }\n    return data || [];\n  } catch (e) {\n    console.warn('[Supabase] getBroadcastsForFixtures error', e);\n    return [];\n  }\n}\nasync function getProvidersByIds(ids = []) {\n  let rows = null;\n  try {\n    let query = supabase.from('providers').select('id,display_name,name,type').order('display_name', {\n      ascending: true\n    });\n    if (ids.length > 0) {\n      query = query.in('id', ids);\n    }\n    const resp = await query;\n    if (resp.error) {\n      console.warn('[Supabase] getProvidersByIds error', resp.error);\n    } else {\n      rows = resp.data;\n    }\n  } catch (e) {\n    console.warn('[Supabase] getProvidersByIds exception', e);\n  }\n  const mapped = (rows || []).map(p => ({\n    id: String(p.id),\n    name: p.display_name || p.name || 'Unknown',\n    type: p.type || 'unknown',\n    href: undefined,\n    status: 'confirmed'\n  }));\n\n  // Fallbacks for common UK providers in case providers table is incomplete\n  const byId = new Map(mapped.map(p => [p.id, p]));\n  const ensure = (numId, name, href) => {\n    const key = String(numId);\n    if (!byId.has(key) && ids.includes(numId)) {\n      byId.set(key, {\n        id: key,\n        name,\n        type: 'tv',\n        href,\n        status: 'confirmed'\n      });\n    }\n  };\n  ensure(1, 'Sky Sports', 'https://www.skysports.com/football/fixtures-results');\n  ensure(2, 'TNT Sports', 'https://tntsports.co.uk/football');\n  return Array.from(byId.values());\n}\nexport async function getFixtures(params = {}) {\n  try {\n    const {\n      teamSlug,\n      dateFrom,\n      dateTo,\n      limit = 100,\n      order = 'asc',\n      competitionId\n    } = params;\n    let query = supabase.from('fixtures_with_teams').select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `).order('utc_kickoff', {\n      ascending: order === 'asc'\n    }).limit(limit);\n    if (dateFrom) {\n      query = query.gte('utc_kickoff', dateFrom);\n    }\n    if (dateTo) {\n      query = query.lte('utc_kickoff', dateTo);\n    }\n    if (competitionId) {\n      query = query.eq('competition_id', competitionId);\n    }\n    const {\n      data: rows,\n      error\n    } = await query;\n    if (error) {\n      console.warn('[Supabase] getFixtures error', error);\n      return [];\n    }\n    if (!rows || !rows.length) return [];\n\n    // Enrich providers in a second step\n    const ids = rows.map(r => r.id).filter(Boolean);\n    let providersByFixture = {};\n    if (ids.length) {\n      const bcasts = await getBroadcastsForFixtures(ids);\n      const providerIds = Array.from(new Set(bcasts.map(b => b.provider_id).filter(Boolean)));\n      const provs = providerIds.length ? await getProvidersByIds(providerIds) : [];\n      const byPk = Object.fromEntries(provs.map(p => [p.id, p]));\n      for (const b of bcasts) {\n        const fId = b.fixture_id;\n        const key = String(b.provider_id);\n        const p = byPk[key];\n        const entry = p ? {\n          ...p\n        } : undefined;\n        if (!providersByFixture[fId]) providersByFixture[fId] = [];\n        if (entry) providersByFixture[fId].push(entry);\n      }\n    }\n    let mapped = rows.map(r => mapFixtureRow(r, providersByFixture));\n\n    // Apply team filter if specified\n    if (teamSlug) {\n      mapped = mapped.filter(fx => fx.home.slug === teamSlug || fx.away.slug === teamSlug);\n    }\n\n    // Apply filtering logic to exclude test fixtures (IDs <= 30)\n    // This matches the current SPA's filtering logic\n    mapped = mapped.filter(f => f.id && f.id > 30);\n    return mapped;\n  } catch (e) {\n    console.warn('[Supabase] getFixtures error', e);\n    return [];\n  }\n}\nexport async function getFixtureById(id) {\n  try {\n    if (!id) return undefined;\n    const {\n      data: rows,\n      error\n    } = await supabase.from('fixtures_with_teams').select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `).eq('id', id).limit(1);\n    if (error) {\n      console.warn('[Supabase] getFixtureById error', error);\n      return undefined;\n    }\n    const row = rows === null || rows === void 0 ? void 0 : rows[0];\n    if (!row) return undefined;\n    const bcasts = await getBroadcastsForFixtures([row.id]);\n    const providerIds = Array.from(new Set(bcasts.map(b => b.provider_id).filter(Boolean)));\n    const provs = providerIds.length ? await getProvidersByIds(providerIds) : [];\n    const byPk = Object.fromEntries(provs.map(p => [p.id, p]));\n    const providersByFixture = {};\n    providersByFixture[row.id] = bcasts.map(b => {\n      const p = byPk[String(b.provider_id)];\n      return p ? {\n        ...p\n      } : null;\n    }).filter(Boolean);\n    return mapFixtureRow(row, providersByFixture);\n  } catch (e) {\n    console.warn('[Supabase] getFixtureById error', e);\n    return undefined;\n  }\n}\n\n// Admin API functions\n\nexport const BROADCASTERS = [{\n  id: 1,\n  name: 'Sky Sports',\n  type: 'tv'\n}, {\n  id: 2,\n  name: 'TNT Sports',\n  type: 'tv'\n}, {\n  id: 3,\n  name: 'BBC Sport',\n  type: 'tv'\n}, {\n  id: 4,\n  name: 'Amazon Prime Video',\n  type: 'streaming'\n}, {\n  id: -1,\n  name: 'ðŸš« Blackout (No TV)',\n  type: 'blackout'\n}];\nexport async function getAdminFixtures(competitionId = 1) {\n  try {\n    // Get fixtures from current season\n    const currentSeasonStart = '2024-08-01T00:00:00.000Z';\n    const {\n      data: rows,\n      error\n    } = await supabase.from('fixtures_with_teams').select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `).eq('competition_id', competitionId).gte('utc_kickoff', currentSeasonStart).order('utc_kickoff', {\n      ascending: true\n    });\n    if (error) {\n      console.warn('[Supabase] getAdminFixtures error', error);\n      return [];\n    }\n    if (!rows || !rows.length) return [];\n\n    // Apply same filtering as main app (exclude test fixtures)\n    const validRows = rows.filter(r => r.id && r.id > 30);\n\n    // Get all broadcasts for these fixtures\n    const fixtureIds = validRows.map(r => r.id);\n    const {\n      data: broadcasts,\n      error: broadcastError\n    } = await supabase.from('broadcasts').select('fixture_id,provider_id').in('fixture_id', fixtureIds);\n    if (broadcastError) {\n      console.warn('[Supabase] Error loading broadcasts:', broadcastError);\n    }\n\n    // Create broadcast lookup\n    const broadcastLookup = {};\n    (broadcasts || []).forEach(b => {\n      broadcastLookup[b.fixture_id] = b;\n    });\n\n    // Map fixtures with broadcast info\n    const adminFixtures = validRows.map(row => {\n      var _BROADCASTERS$find;\n      const broadcast = broadcastLookup[row.id] || null;\n      const fixture = mapFixtureRow(row);\n      return {\n        ...fixture,\n        broadcast: broadcast ? {\n          provider_id: broadcast.provider_id,\n          provider_display_name: ((_BROADCASTERS$find = BROADCASTERS.find(b => b.id === broadcast.provider_id)) === null || _BROADCASTERS$find === void 0 ? void 0 : _BROADCASTERS$find.name) || 'Unknown'\n        } : null\n      };\n    });\n    return adminFixtures;\n  } catch (e) {\n    console.warn('[Supabase] getAdminFixtures error', e);\n    return [];\n  }\n}\nexport async function saveBroadcast(fixtureId, providerId) {\n  try {\n    if (providerId === '' || providerId === '0' || providerId === '-1' || providerId === null) {\n      // Delete existing broadcast record\n      const {\n        error\n      } = await supabase.from('broadcasts').delete().eq('fixture_id', fixtureId);\n      if (error) {\n        throw error;\n      }\n\n      // Handle blackout localStorage logic\n      if (providerId === '-1') {\n        const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n        if (!blackoutFixtures.includes(fixtureId)) {\n          blackoutFixtures.push(fixtureId);\n          localStorage.setItem('blackoutFixtures', JSON.stringify(blackoutFixtures));\n        }\n      } else {\n        // Remove from blackout list if setting to empty\n        const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n        const updatedBlackout = blackoutFixtures.filter(id => id !== fixtureId);\n        localStorage.setItem('blackoutFixtures', JSON.stringify(updatedBlackout));\n      }\n    } else {\n      // Add/update broadcaster - remove from blackout list first\n      const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n      const updatedBlackout = blackoutFixtures.filter(id => id !== fixtureId);\n      localStorage.setItem('blackoutFixtures', JSON.stringify(updatedBlackout));\n      const broadcastData = {\n        fixture_id: fixtureId,\n        provider_id: parseInt(String(providerId))\n      };\n\n      // Upsert the broadcast record\n      const {\n        error\n      } = await supabase.from('broadcasts').upsert(broadcastData);\n      if (error) {\n        throw error;\n      }\n    }\n  } catch (e) {\n    console.error('[Supabase] saveBroadcast error', e);\n    throw e;\n  }\n}\n\n// Blackout helper functions\nexport function isFixtureBlackout(fixtureId) {\n  const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n  return blackoutFixtures.includes(fixtureId);\n}\nexport function isFixtureConfirmed(fixture) {\n  return !!(fixture.broadcast && fixture.broadcast.provider_id && !isFixtureBlackout(fixture.id));\n}\nexport function isFixturePending(fixture) {\n  return !fixture.broadcast && !isFixtureBlackout(fixture.id);\n}\n\n// Teams API\nexport async function getTeams() {\n  try {\n    const {\n      data,\n      error\n    } = await supabase.from('teams').select('id,name,slug,crest_url').eq('is_active', true).order('name', {\n      ascending: true\n    });\n    if (error) {\n      console.warn('[Supabase] getTeams error', error);\n      return [];\n    }\n    return (data || []).map(t => {\n      var _t$crest_url;\n      return {\n        id: t.id,\n        name: t.name,\n        slug: t.slug,\n        crest: (_t$crest_url = t.crest_url) !== null && _t$crest_url !== void 0 ? _t$crest_url : null\n      };\n    });\n  } catch (e) {\n    console.warn('[Supabase] getTeams error', e);\n    return [];\n  }\n}","map":{"version":3,"names":["createClient","supabaseUrl","process","env","REACT_APP_SUPABASE_URL","supabaseAnonKey","REACT_APP_SUPABASE_ANON_KEY","Error","supabase","mapFixtureRow","row","providersByFixture","_row$matchday","_row$venue","kickoffIso","utc_kickoff","mw","matchday","home","id","home_team_id","name","home_team","slug","home_slug","crest","home_crest","away","away_team_id","away_team","away_slug","away_crest","providers","blackoutFixtures","JSON","parse","localStorage","getItem","isBlackout","includes","sport","competition","matchweek","kickoff_utc","venue","providers_uk","blackout","is_blackout","reason","status","getBroadcastsForFixtures","ids","length","data","error","from","select","in","console","warn","e","getProvidersByIds","rows","query","order","ascending","resp","mapped","map","p","String","display_name","type","href","undefined","byId","Map","ensure","numId","key","has","set","Array","values","getFixtures","params","teamSlug","dateFrom","dateTo","limit","competitionId","gte","lte","eq","r","filter","Boolean","bcasts","providerIds","Set","b","provider_id","provs","byPk","Object","fromEntries","fId","fixture_id","entry","push","fx","f","getFixtureById","BROADCASTERS","getAdminFixtures","currentSeasonStart","validRows","fixtureIds","broadcasts","broadcastError","broadcastLookup","forEach","adminFixtures","_BROADCASTERS$find","broadcast","fixture","provider_display_name","find","saveBroadcast","fixtureId","providerId","delete","setItem","stringify","updatedBlackout","broadcastData","parseInt","upsert","isFixtureBlackout","isFixtureConfirmed","isFixturePending","getTeams","t","_t$crest_url","crest_url"],"sources":["/Users/p/Documents/pl_tv_mvp_spa/react-version/src/services/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\nimport type { Fixture, FixturesApiParams, Provider, Team } from '../types';\n\n// Require credentials from environment variables\nconst supabaseUrl = process.env.REACT_APP_SUPABASE_URL;\nconst supabaseAnonKey = process.env.REACT_APP_SUPABASE_ANON_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  throw new Error('[Supabase] Missing REACT_APP_SUPABASE_URL or REACT_APP_SUPABASE_ANON_KEY');\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n\ninterface FixtureRow {\n  id: number;\n  matchday?: number | null;\n  utc_kickoff: string;\n  venue?: string | null;\n  status?: string;\n  home_team_id: number;\n  home_team: string;\n  home_slug: string;\n  home_crest?: string | null;\n  away_team_id: number;\n  away_team: string;\n  away_slug: string;\n  away_crest?: string | null;\n}\n\ninterface BroadcastRow {\n  fixture_id: number;\n  provider_id: number;\n}\n\ninterface ProviderRow {\n  id: number;\n  display_name?: string;\n  name?: string;\n  type?: string;\n  url?: string;\n}\n\nfunction mapFixtureRow(row: FixtureRow, providersByFixture: Record<number, Provider[]> = {}): Fixture {\n  const kickoffIso = row.utc_kickoff;\n  const mw = row.matchday ?? null;\n  const home: Team = {\n    id: row.home_team_id,\n    name: row.home_team,\n    slug: row.home_slug,\n    crest: row.home_crest || null,\n  };\n  const away: Team = {\n    id: row.away_team_id,\n    name: row.away_team,\n    slug: row.away_slug,\n    crest: row.away_crest || null,\n  };\n  const providers = providersByFixture[row.id] || [];\n\n  // Check blackout status from localStorage (matching original SPA logic)\n  const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n  const isBlackout = blackoutFixtures.includes(row.id);\n\n  return {\n    id: row.id,\n    sport: 'football',\n    competition: 'premier-league',\n    matchweek: mw,\n    kickoff_utc: kickoffIso,\n    venue: row.venue ?? null,\n    home,\n    away,\n    providers_uk: providers,\n    blackout: { \n      is_blackout: isBlackout, \n      reason: isBlackout ? 'No UK broadcaster announced' : null \n    },\n    status: row.status || 'scheduled',\n  };\n}\n\nasync function getBroadcastsForFixtures(ids: number[]): Promise<BroadcastRow[]> {\n  try {\n    if (!ids || !ids.length) return [];\n    \n    const { data, error } = await supabase\n      .from('broadcasts')\n      .select('fixture_id,provider_id')\n      .in('fixture_id', ids);\n      \n    if (error) {\n      console.warn('[Supabase] getBroadcastsForFixtures error', error);\n      return [];\n    }\n    \n    return data || [];\n  } catch (e) {\n    console.warn('[Supabase] getBroadcastsForFixtures error', e);\n    return [];\n  }\n}\n\nasync function getProvidersByIds(ids: number[] = []): Promise<Provider[]> {\n  let rows: ProviderRow[] | null = null;\n  try {\n    let query = supabase\n      .from('providers')\n      .select('id,display_name,name,type')\n      .order('display_name', { ascending: true });\n\n    if (ids.length > 0) {\n      query = query.in('id', ids);\n    }\n\n    const resp = await query;\n    if (resp.error) {\n      console.warn('[Supabase] getProvidersByIds error', resp.error);\n    } else {\n      rows = resp.data as any;\n    }\n  } catch (e) {\n    console.warn('[Supabase] getProvidersByIds exception', e);\n  }\n\n  const mapped = (rows || []).map((p: ProviderRow) => ({\n    id: String(p.id),\n    name: p.display_name || p.name || 'Unknown',\n    type: p.type || 'unknown',\n    href: undefined,\n    status: 'confirmed',\n  }));\n\n  // Fallbacks for common UK providers in case providers table is incomplete\n  const byId = new Map<string, Provider>(mapped.map(p => [p.id, p]));\n  const ensure = (numId: number, name: string, href: string) => {\n    const key = String(numId);\n    if (!byId.has(key) && ids.includes(numId)) {\n      byId.set(key, { id: key, name, type: 'tv', href, status: 'confirmed' });\n    }\n  };\n  ensure(1, 'Sky Sports', 'https://www.skysports.com/football/fixtures-results');\n  ensure(2, 'TNT Sports', 'https://tntsports.co.uk/football');\n\n  return Array.from(byId.values());\n}\n\nexport async function getFixtures(params: FixturesApiParams = {}): Promise<Fixture[]> {\n  try {\n    const {\n      teamSlug,\n      dateFrom,\n      dateTo,\n      limit = 100,\n      order = 'asc',\n      competitionId\n    } = params;\n\n    let query = supabase\n      .from('fixtures_with_teams')\n      .select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `)\n      .order('utc_kickoff', { ascending: order === 'asc' })\n      .limit(limit);\n      \n    if (dateFrom) {\n      query = query.gte('utc_kickoff', dateFrom);\n    }\n    if (dateTo) {\n      query = query.lte('utc_kickoff', dateTo);\n    }\n    if (competitionId) {\n      query = query.eq('competition_id', competitionId);\n    }\n\n    const { data: rows, error } = await query;\n    \n    if (error) {\n      console.warn('[Supabase] getFixtures error', error);\n      return [];\n    }\n    \n    if (!rows || !rows.length) return [];\n\n    // Enrich providers in a second step\n    const ids = rows.map(r => r.id).filter(Boolean);\n    let providersByFixture: Record<number, Provider[]> = {};\n    \n    if (ids.length) {\n      const bcasts = await getBroadcastsForFixtures(ids);\n      const providerIds = Array.from(new Set(bcasts.map(b => b.provider_id).filter(Boolean)));\n      const provs = providerIds.length ? await getProvidersByIds(providerIds) : [];\n      const byPk = Object.fromEntries(provs.map(p => [p.id, p]));\n\n      for (const b of bcasts) {\n        const fId = b.fixture_id;\n        const key = String(b.provider_id);\n        const p = byPk[key];\n        const entry = p ? { ...p } : undefined;\n        if (!providersByFixture[fId]) providersByFixture[fId] = [];\n        if (entry) providersByFixture[fId].push(entry);\n      }\n    }\n    \n    let mapped = rows.map(r => mapFixtureRow(r, providersByFixture));\n\n    // Apply team filter if specified\n    if (teamSlug) {\n      mapped = mapped.filter(fx => fx.home.slug === teamSlug || fx.away.slug === teamSlug);\n    }\n    \n    // Apply filtering logic to exclude test fixtures (IDs <= 30)\n    // This matches the current SPA's filtering logic\n    mapped = mapped.filter(f => f.id && f.id > 30);\n    \n    return mapped;\n  } catch (e) {\n    console.warn('[Supabase] getFixtures error', e);\n    return [];\n  }\n}\n\nexport async function getFixtureById(id: number): Promise<Fixture | undefined> {\n  try {\n    if (!id) return undefined;\n    \n    const { data: rows, error } = await supabase\n      .from('fixtures_with_teams')\n      .select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `)\n      .eq('id', id)\n      .limit(1);\n      \n    if (error) {\n      console.warn('[Supabase] getFixtureById error', error);\n      return undefined;\n    }\n    \n    const row = rows?.[0];\n    if (!row) return undefined;\n    \n    const bcasts = await getBroadcastsForFixtures([row.id]);\n    const providerIds = Array.from(new Set(bcasts.map(b => b.provider_id).filter(Boolean)));\n    const provs = providerIds.length ? await getProvidersByIds(providerIds) : [];\n    const byPk = Object.fromEntries(provs.map(p => [p.id, p]));\n\n    const providersByFixture: Record<number, Provider[]> = {};\n    providersByFixture[row.id] = bcasts.map(b => {\n      const p = byPk[String(b.provider_id)];\n      return p ? { ...p } : null;\n    }).filter(Boolean) as Provider[];\n    \n    return mapFixtureRow(row, providersByFixture);\n  } catch (e) {\n    console.warn('[Supabase] getFixtureById error', e);\n    return undefined;\n  }\n}\n\n// Admin API functions\n\nexport interface AdminFixture extends Fixture {\n  broadcast?: {\n    provider_id: number;\n    provider_display_name?: string;\n    channel?: string;\n  } | null;\n}\n\nexport const BROADCASTERS = [\n  { id: 1, name: 'Sky Sports', type: 'tv' },\n  { id: 2, name: 'TNT Sports', type: 'tv' },\n  { id: 3, name: 'BBC Sport', type: 'tv' },\n  { id: 4, name: 'Amazon Prime Video', type: 'streaming' },\n  { id: -1, name: 'ðŸš« Blackout (No TV)', type: 'blackout' }\n];\n\nexport async function getAdminFixtures(competitionId: number = 1): Promise<AdminFixture[]> {\n  try {\n    // Get fixtures from current season\n    const currentSeasonStart = '2024-08-01T00:00:00.000Z';\n    \n    const { data: rows, error } = await supabase\n      .from('fixtures_with_teams')\n      .select(`\n        id,matchday,utc_kickoff,venue,status,\n        home_team_id,home_team,home_slug,home_crest,\n        away_team_id,away_team,away_slug,away_crest\n      `)\n      .eq('competition_id', competitionId)\n      .gte('utc_kickoff', currentSeasonStart)\n      .order('utc_kickoff', { ascending: true });\n      \n    if (error) {\n      console.warn('[Supabase] getAdminFixtures error', error);\n      return [];\n    }\n    \n    if (!rows || !rows.length) return [];\n\n    // Apply same filtering as main app (exclude test fixtures)\n    const validRows = rows.filter(r => r.id && r.id > 30);\n    \n    // Get all broadcasts for these fixtures\n    const fixtureIds = validRows.map(r => r.id);\n    const { data: broadcasts, error: broadcastError } = await supabase\n      .from('broadcasts')\n      .select('fixture_id,provider_id')\n      .in('fixture_id', fixtureIds);\n      \n    if (broadcastError) {\n      console.warn('[Supabase] Error loading broadcasts:', broadcastError);\n    }\n    \n    // Create broadcast lookup\n    const broadcastLookup: Record<number, BroadcastRow> = {};\n    (broadcasts || []).forEach(b => {\n      broadcastLookup[b.fixture_id] = b;\n    });\n    \n    // Map fixtures with broadcast info\n    const adminFixtures: AdminFixture[] = validRows.map(row => {\n      const broadcast = broadcastLookup[row.id] || null;\n      const fixture = mapFixtureRow(row);\n      \n      return {\n        ...fixture,\n        broadcast: broadcast ? {\n          provider_id: broadcast.provider_id,\n          provider_display_name: BROADCASTERS.find(b => b.id === broadcast.provider_id)?.name || 'Unknown'\n        } : null\n      };\n    });\n    \n    return adminFixtures;\n  } catch (e) {\n    console.warn('[Supabase] getAdminFixtures error', e);\n    return [];\n  }\n}\n\nexport async function saveBroadcast(fixtureId: number, providerId: number | string | null): Promise<void> {\n  try {\n    if (providerId === '' || providerId === '0' || providerId === '-1' || providerId === null) {\n      // Delete existing broadcast record\n      const { error } = await supabase\n        .from('broadcasts')\n        .delete()\n        .eq('fixture_id', fixtureId);\n        \n      if (error) {\n        throw error;\n      }\n      \n      // Handle blackout localStorage logic\n      if (providerId === '-1') {\n        const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n        if (!blackoutFixtures.includes(fixtureId)) {\n          blackoutFixtures.push(fixtureId);\n          localStorage.setItem('blackoutFixtures', JSON.stringify(blackoutFixtures));\n        }\n      } else {\n        // Remove from blackout list if setting to empty\n        const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n        const updatedBlackout = blackoutFixtures.filter((id: number) => id !== fixtureId);\n        localStorage.setItem('blackoutFixtures', JSON.stringify(updatedBlackout));\n      }\n    } else {\n      // Add/update broadcaster - remove from blackout list first\n      const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n      const updatedBlackout = blackoutFixtures.filter((id: number) => id !== fixtureId);\n      localStorage.setItem('blackoutFixtures', JSON.stringify(updatedBlackout));\n      \n      const broadcastData = {\n        fixture_id: fixtureId,\n        provider_id: parseInt(String(providerId))\n      };\n      \n      // Upsert the broadcast record\n      const { error } = await supabase\n        .from('broadcasts')\n        .upsert(broadcastData);\n        \n      if (error) {\n        throw error;\n      }\n    }\n  } catch (e) {\n    console.error('[Supabase] saveBroadcast error', e);\n    throw e;\n  }\n}\n\n// Blackout helper functions\nexport function isFixtureBlackout(fixtureId: number): boolean {\n  const blackoutFixtures = JSON.parse(localStorage.getItem('blackoutFixtures') || '[]');\n  return blackoutFixtures.includes(fixtureId);\n}\n\nexport function isFixtureConfirmed(fixture: AdminFixture): boolean {\n  return !!(fixture.broadcast && fixture.broadcast.provider_id && !isFixtureBlackout(fixture.id));\n}\n\nexport function isFixturePending(fixture: AdminFixture): boolean {\n  return !fixture.broadcast && !isFixtureBlackout(fixture.id);\n}\n\n// Teams API\nexport async function getTeams(): Promise<Team[]> {\n  try {\n    const { data, error } = await supabase\n      .from('teams')\n      .select('id,name,slug,crest_url')\n      .eq('is_active', true)\n      .order('name', { ascending: true });\n\n    if (error) {\n      console.warn('[Supabase] getTeams error', error);\n      return [];\n    }\n    return (data || []).map((t: any) => ({\n      id: t.id,\n      name: t.name,\n      slug: t.slug,\n      crest: t.crest_url ?? null,\n    }));\n  } catch (e) {\n    console.warn('[Supabase] getTeams error', e);\n    return [];\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}